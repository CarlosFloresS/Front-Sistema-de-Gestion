<app-navbar></app-navbar>

<div class="form-page-container">
  <div class="form-card-grid">
    <!-- 1. Barra Lateral (Izquierda) - El contenido ahora depende de 'isEdit' -->
    <div class="form-sidebar">
      <div class="sidebar-content">
        <mat-icon class="sidebar-icon">{{ isEdit ? 'edit_note' : 'inventory_2' }}</mat-icon>
        <h2>{{ isEdit ? 'Editar Producto' : 'Nuevo Producto' }}</h2>
        <p>
          {{ isEdit ? 'Modifica los detalles a continuación. Los cambios se reflejarán en todo el sistema.' : 'Completa la información para registrar un nuevo producto en tu inventario.' }}
        </p>
      </div>
    </div>

    <!-- 2. Área Principal (Derecha) - El Formulario -->
    <div class="form-main">
      <form [formGroup]="form" (ngSubmit)="submit()">
        <!-- Campo de Nombre -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Nombre del Producto</mat-label>
          <input matInput formControlName="nombre" />
          <mat-error *ngIf="form.get('nombre')?.hasError('required')">El nombre es obligatorio.</mat-error>
          <mat-error *ngIf="form.get('nombre')?.hasError('maxlength')">El nombre no puede exceder los 80 caracteres.</mat-error>
        </mat-form-field>

        <!-- CAMBIO: Nuevo campo Descripción -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Descripción (Opcional)</mat-label>
          <textarea matInput formControlName="descripcion" rows="3"></textarea>
          <mat-error *ngIf="form.get('descripcion')?.hasError('maxlength')">La descripción no puede exceder los 255 caracteres.</mat-error>
        </mat-form-field>

        <!-- CAMBIO: Nuevos campos de Precio y Costo en una fila -->
        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Precio de Venta</mat-label>
            <input matInput type="number" formControlName="precio" />
            <span matTextPrefix>S/&nbsp;</span>
            <mat-error *ngIf="form.get('precio')?.hasError('required')">El precio es obligatorio.</mat-error>
            <mat-error *ngIf="form.get('precio')?.hasError('min')">El precio debe ser mayor a 0.</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Costo de Adquisición</mat-label>
            <input matInput type="number" formControlName="costo" />
            <span matTextPrefix>S/&nbsp;</span>
            <mat-error *ngIf="form.get('costo')?.hasError('required')">El costo es obligatorio.</mat-error>
            <mat-error *ngIf="form.get('costo')?.hasError('min')">El costo no puede ser negativo.</mat-error>
          </mat-form-field>
        </div>

        <!-- Botonera de Acciones -->
        <div class="form-actions">
          <button mat-button type="button" (click)="cancel()">Cancelar</button>
          <button mat-flat-button class="main-action-btn" type="submit" [disabled]="form.invalid || isLoading">
            <span *ngIf="!isLoading">{{ isEdit ? 'Guardar Cambios' : 'Crear Producto' }}</span>
            <mat-spinner *ngIf="isLoading" diameter="24"></mat-spinner>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
